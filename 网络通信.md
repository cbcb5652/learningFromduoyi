# 网络通信

> TCP/UDP/HTTP
>
> - TCP/UDP： 传输层协议，主要解决数据如何在网络中传输
> - HTTP: 应用层协议，主要解决如何包装数据

我们在传输数据的时候可以只使用TCP/IP协议，但是那样的话，如果没有应用层，便无法识别数据内容，如果想要使传输层的数据有意义，则必须使用到应用层协议: ==TCP,FTP,TELNET==, 也可以自己定义应用层协议。WEB使用HTTP协议作应用层协议，以封装HTTP应用层文本信息，然后使用TCP/IP将数据发送到网络上。

- IP代表协议，TCP和UDP使用该协议从一个网络传输到另一个网络，就好比一条==高速公路==，允许其他协议在上面行驶
- 而TCP和UDP就类似高速公路上的==卡车==，携带的==货物==就像HTTP，FTP这样的协议等。

可以这样理解，TCP，UDP是FTP,SMTP，HTTP之类使用来传输的传输层协议。

| 级数 | 层名       | 协议                             |
| ---- | ---------- | -------------------------------- |
| 7    | 应用层     | HTTP,SMTP,FTP,TeInet,SSH,XMPP    |
| 6    | 表示层     | XDR, ASN, SMB,AFP,NCP            |
| 5    | 会话层     | TLS,SSH,RPC,ASP,Winsock          |
| 4    | 传输层     | TCP,UDP,RTP,SCTP,AYP             |
| 3    | 网络层     | IP,ICMP,BGP,ARP,IPX,BGP,OSPF,RIP |
| 2    | 数据链路层 | 以太网，HDLC，ISDN,ATM           |
| 1    | 物理层     | 线路，无线电，光纤，信鸽         |

----

**HTTP**

> - 连接：传输层的环流，建立在两个互相通讯的应用程序之间
> - 消息：HTTP通讯的基本单位，通过连接传输
> - 请求：客户端到服务端的请求信息包括 应用于资源的方法，资源的标识符，协议版本号等
> - 响应：一个从服务器返回的信息包括HTTP协议的版本号，请求的状态，文档的MIME类型
> - 资源：由URI表示的网咯数据对象或服务
> - 实体：数据资源或来自服务资源特殊的表示方法，可能被包围在一个请求或响应中。一个实体包括头信息和实体的本身内容
> - 客户机：一个为发送请求而建立连接的程序
> - 用户代理：初始化一个请求的客户机，它们是浏览器，编辑器或其他工具
> - 服务器：一个接受连接并对请求返回信息的应用程序

HTTP/1.0 请求消息格式为:   

​	请求消息 = 请求行(通用信息|请求头|实体头) CRLF[实体内容]

​	请求行 = 方法 请求URL HTTP版本号 CRLF

- 方法 = GET|HEAD|POST|扩展方法
- URL = 协议名称 + 宿主名 + 目录与文件名

响应信息: 

- 1×× 保留
- 2×× 表示请求成功地接收
- 3×× 为完成请求客户需进一步细化请求
-  4×× 客户错误
- 5×× 服务器错误

----

**TCP**

> 面向连接，可靠的传输层协议
>
> TCP是建立在不可靠的IP 协议之上的，IP不提供任何可靠的机制，可靠性都是TCP自己实现的

==超时重传，流量控制==

- **超时重传：** 客户端发送某个数据就开启一个定时器，在一定时间内如果没有接受到ACK响应报文，那么就重新发送数据，直到发送成功为止。

决定报文是否有必要重传的主要机制是重传计时器，主要功能是维护重传超时(RTO)值。当使用TCP传输时，重传计时器启动，收到ACK时计时器停止。报文发送至接受到ACK的时间称为往返值。对若干次时间取平均值，该值就决定了RTO的最终取值。

假设发送方报文丢失并将其重传，重传会将RTO翻倍，往复多次，直至达到配置的最大次数。windows 5次。Linux 15次(默认)

**快速重传:**   接受数据的一方发现有数据丢失了（并不是所期待的值。这意味着报文在传送中丢失。接收端注意到报文乱序，并在在第三个报文中发送重复ACK）。就会发送重复ACK报文高速发送端重传丢失的报文。当发送端收到3个重复的ACK之后，会触发快速重传，所有正在传输的报文都被放入队列中，直到快速重传报文发送为止。（重复多次失效，则暂停其他报文，专心做该报文的数据传输）。



- **流量控制:**    让发送速率不要过快，让接收方来得及接受。利用滑动窗口

滑动窗口是流量控制的一种技术。

> 早期通信过程中，通信双方不会考虑网络的拥挤情况直接发送数据。由于大家都不知道网络的拥挤情况，一起发送数据，导致中间结点阻塞掉包，谁也发不了数据。所以就有了滑动窗口机制来解决此问题。



![image-20201223180438772](E:\idea\workplace\images\image-20201223180438772.png)

三次握手，四次挥手： https://blog.csdn.net/qq_38950316/article/details/81087809



**UDP**

> 无连接的，不可靠的传输层协议。
>
> UDP以其简单，传输快的优势，在越来越多场景下取代TCP，如网页浏览，流媒体，实时游戏，物联网

1. 网速的提升给UDP稳定性提供可靠的网络保障
2. 对比测试结果UDP性能优于TCP
3. TCP设计过于冗余，速度难以进一步提升
4. UDP协议以其简单，传输快的优势，在越来越多场景下取代了TCP









## Netty























## Socket

























## RPC











































